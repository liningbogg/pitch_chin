<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>数据：{{title}}</title>
    <script src="http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/highcharts.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/exporting.js"></script>
    <script src="/static/js/labeling.js?time='+new Date().getTime()+'"></script>
    <link href="/static/css/labeling.css?time='+new Date().getTime()+'" rel="stylesheet" type="text/css" />
	<link rel="icon" href="/static/image/favicon.ico" mce_href=”/static/image/favicon.ico” type=”image/x-icon”>
	<link rel="bookmark" href="/static/image/favicon.ico" mce_href=”/static/image/favicon.ico” type=”image/x-icon”>
</head>
<body>
<div class="login" id="login" style="border-width:1px; color:blue">
    <a href="../index/">主页</a>
    {% include "login_info_base.html" %}
</div>
<div  class="vad" id="vad" style="border-width:1px; color:blue">

</div>
<div class="primary" id="primary" style="border-width:1px; border-style:solid; border-color:red;">
	<div  class="info" id="info" style="border-width:1px; border-style:solid; border-color:green;">
		<table border="" class="table_info" name="table_info" >
			<thead>
				<tr>
					<th >属性</th>
					<th >数值</th>
				</tr>
			</thead>
			<tr>
				<td>title</td>
				<td>
					<input type="text" name="title" readonly="true" value={{title|safe}} />
				</td>
			</tr>
			<tr>
				<td>frameNum</td>
				<td>
					<input type="text" name="frame_num" readonly="true" value={{frame_num|safe}} />
				</td>
			</tr>
			<tr>
				<td style="font-size:24px;line-height:1;color:green">current_frame</td>
				<td>
					<input type="text" name="current_frame" readonly="true" value={{current_frame|safe}} style="color:green" />
				</td>
			</tr>
			<tr>
				<td>manual_pos</td>
				<td>
					<input type="number" name="manual_pos"  value={{manual_pos|safe}} placeholder="指定下次标记的位置，否则置为负数"/>
				</td>
			</tr>
			<tr>
				<td>nfft</td>
				<td>
					<input type="text" name="nfft" readonly="true" value={{nfft|safe}} />
				</td>
			</tr>
			<tr>
				<td>extend_rad</td>
				<td>
					<input type="number" name="extend_rad" value={{extend_rad|safe}} placeholder="当前标记视窗半径"/>
				</td>
			</tr>
			<tr>
				<td>tone_extend_rad</td>
				<td>
					<input type="number" name="tone_extend_rad" value={{tone_extend_rad|safe}} placeholder="音符参考半径"/>
				</td>
			</tr>
			<tr>
				<td>vad_thrart_EE</td>
				<td>
					<input type="number" name="vad_thrart_EE" value={{vad_thrart_EE|safe}} placeholder="起始位置判定熵阈值"/>
				</td>
			</tr>
			<tr>
				<td>vad_throp_EE</td>
				<td>
					<input type="number" name="vad_throp_EE" value={{vad_throp_EE|safe}} placeholder="终止位置判定熵阈值"/>
				</td>
			</tr>
			<tr>
				<td>vad_thrart_RMSE</td>
				<td>
					<input type="number" name="vad_thrart_RMSE" value={{vad_thrart_RMSE|safe}} placeholder="起始位置判定能量阈值"/>
				</td>
			</tr>
			<tr>
				<td>create_user_id</td>
				<td>
					<input type="text" readonly="true" name="create_user_id" value={{create_user_id|safe}} />
				</td>
			</tr>
		</table>
	</div>
	<div class="local_pitch" id="local_pitch" style="border-width:1px; border-style:solid; border-color:blue;">
		
	</div>
	<div class="local_target" id="local_target" style="border-width:1px; border-style:solid; border-color:red;">
		
	</div>
	<div class="sampling_data" id="sampling_data" style="border-width:1px; border-style:solid; border-color:purple;">
		<div class="sampling_fft" id="sampling_fft" style="border-width:1px; border-style:solid; border-color:green;">

		</div>
		<div class="sampling_medium" id="sampling_medium" style="border-width:1px; border-style:solid; border-color:green;">

		</div>
	</div>
</div>
<div class="ref" id="ref" style="border-width:1px; border-style:solid; border-color:red;">

</div>
<script>
    //关于端点检测的字典数组
    var vadChartDictSeries={"spectral_entropy":{{ee|safe}},"rmse":{{rmse|safe}}};
    var vadChartDictLine={
		"stopPos":{{stopPos|safe}},
        "startPos":{{startPos|safe}}	
	};
	var current_frame = {{current_frame|safe}};
	var extend_rad = {{extend_rad|safe}};
	var start_pos = Math.max(0,current_frame-extend_rad);
	var frame_end = {{frame_num|safe}};
	start_pos = Math.min(start_pos,frame_end);
	var end_pos = Math.max(0,current_frame+extend_rad);
	end_pos = Math.min(end_pos,frame_end);
    addChart("",vadChartDictSeries,vadChartDictLine, current_frame,"vad",start_pos,end_pos);
</script>
<script>
	//comb及combDescan用户提供的参考标记
	var refChartDictSeries={"combDescan1":{{combDescanPrimary|safe}},"combdeScan2":{{combDescanSecondary|safe}},"comb":{{comb|safe}}};
    var refChartDictLine={
		"stopPos":{{stopPos|safe}},
        "startPos":{{startPos|safe}}	
	};
	var current_frame = {{current_frame|safe}};
	var extend_rad = {{extend_rad|safe}};
	var start_pos = Math.max(0,current_frame-extend_rad);
	var frame_end = {{frame_num|safe}};
	start_pos = Math.min(start_pos,frame_end);
	var end_pos = Math.max(0,current_frame+extend_rad);
	end_pos = Math.min(end_pos,frame_end);
    addChart("",refChartDictSeries,refChartDictLine, current_frame,"local_pitch",start_pos,end_pos);
</script>
<script>
	//已标记音高信息
	var targetArr={{target|safe}};
	var targetChartDictSeries={"target1":targetArr[0],"target2":targetArr[1],"target3":targetArr[2]};
    var targetChartDictLine={
		"stopPos":{{stopPos|safe}},
        "startPos":{{startPos|safe}}	
	};
	var current_frame = {{current_frame|safe}};
	var extend_rad = {{extend_rad|safe}};
	var start_pos = Math.max(0,current_frame-extend_rad);
	var frame_end = {{frame_num|safe}};
	start_pos = Math.min(start_pos,frame_end);
	var end_pos = Math.max(0,current_frame+extend_rad);
	end_pos = Math.min(end_pos,frame_end);
    addChart("",targetChartDictSeries,targetChartDictLine, current_frame,"local_target",start_pos,end_pos);
</script>
<script>
	//fft显示
	var srcChartDictSeries={"fft":{{srcFFT|safe}}};
	var nfft={{nfft|safe}};
	var fs={{fs|safe}};
	srcChartDictLine=[];
    addChart("",srcChartDictSeries,srcChartDictLine,440*nfft/fs,"sampling_fft",0,parseInt(4000*nfft/fs));
</script>
<script>
	//medium梳状投影
	var mediumChartDictSeries={"medium":{{medium|safe}}};
	var fs={{fs|safe}};
	mediumChartDictLine=[];
    addChart("",mediumChartDictSeries,mediumChartDictLine,440*441000/fs,"sampling_medium",0,mediumChartDictSeries["medium"].length);
</script>
</body>
</html>
